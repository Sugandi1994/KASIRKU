<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>POS Sederhana</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="login">
        <h2>Login POS</h2>
        <input id="username" placeholder="Username"><br>
        <input id="password" type="password" placeholder="Password"><br>
        <button onclick="login()">Login</button>
        <div id="login-msg"></div>
    </div>
    <div id="dashboard" style="display:none;">
        <div class="main-layout">
            <aside id="sidebar">
                <div class="sidebar-header">
                    <span id="role"></span>
                </div>
                <!-- Dashboard Menu Vertical -->
                <div class="dashboard-menu-vertical">
                    <button onclick="showPage('user')" id="nav-user"><span>Kelola User</span></button>
                    <button onclick="showPage('produk')" id="nav-produk"><span>Kelola Produk</span></button>
                    <button onclick="showPage('kategori')" id="nav-kategori"><span>Kelola Kategori</span></button>
                    <button onclick="showPage('transaksi')" id="nav-transaksi"><span>Transaksi</span></button>
                    <button onclick="showPage('daftar')" id="nav-daftar"><span>Daftar Transaksi</span></button>
                    <button onclick="logout()" id="nav-logout" class="logout-btn"><span>Logout</span></button>
                </div>
            </aside>
            <main id="main-content">
                <!-- User Management Page -->
                <section id="page-user" class="page" style="display:none;">
                    <h3>Kelola User</h3>
                    <button id="toggle-user-form-btn" onclick="toggleUserForm()">Tambah User Baru</button>
                    <div id="user-form-container" style="display:none; margin-top: 10px;">
                        <h4 id="user-form-title">Tambah User Baru</h4>
                        <input id="newuser" placeholder="Username">
                        <input id="newpass" type="password" placeholder="Password">
                        <select id="newrole">
                            <option value="kasir">Kasir</option>
                            <option value="admin">Admin</option>
                        </select>
                        <button onclick="saveUser()" id="user-save-btn">Tambah</button>
                        <button onclick="cancelEditUser()" id="user-cancel-btn" style="display:none;">Batal</button>
                        <div id="adduser-msg"></div>
                    </div>
                    <div id="user-list"></div>
                </section>
                <!-- Produk Management Page -->
                <section id="page-produk" class="page" style="display:none;">
                    <h3>Kelola Produk</h3>
                    <button id="toggle-product-form-btn" onclick="toggleProductForm()">Tambah Produk</button>
                    <div id="product-form-container" style="display:none; margin-top: 10px;">
                        <h3 id="product-form-title">Tambah Produk</h3>
                        <input id="prodname" placeholder="Nama Produk">
                        <input id="prodbuy" type="number" placeholder="Harga Beli">
                        <input id="prodsell" type="number" placeholder="Harga Jual">
                        <input id="prodstock" type="number" placeholder="Stok">
<select id="prodcategory">
    <option value="">-- Pilih Kategori --</option>
</select>
                        <button onclick="saveProduct()" id="product-save-btn">Tambah</button>
                        <button onclick="cancelEditProduct()" id="product-cancel-btn" style="display:none;">Batal</button>
                        <div id="addprod-msg"></div>
                    </div>
                    <div style="margin-bottom: 12px; display: flex; gap: 8px; flex-wrap: wrap; align-items: center;">
                        <input type="file" id="import-excel-file" accept=".xlsx,.xls" style="flex-grow: 1; min-width: 180px;">
<button onclick="importProductsFromExcel()" style="flex-shrink: 0;">Import Excel</button>
<div id="import-loading" style="display:none; margin-left: 10px; width: 200px;">
    <progress id="import-progress" value="0" max="100" style="width: 100%; height: 16px;"></progress>
    <span id="import-progress-text" style="font-size: 12px; color: #168bff; display: block; text-align: center;">0%</span>
</div>
<button onclick="exportProductsExcel()" style="flex-shrink: 0;">Export Excel</button>
                        <label style="display:flex; align-items:center; gap:4px; font-size:14px; user-select:none;">
                            <input type="checkbox" id="toggle-pagination-checkbox" checked onchange="toggleProductPagination(this.checked)">
                            Tampilkan Pagination
                        </label>
                        <button onclick="deleteAllProducts()" style="flex-shrink: 0; background: #c0392b; color: white;">Hapus Semua Produk</button>
                    </div>
                    <div id="product-list"></div>
                </section>
                <!-- Transaksi Penjualan Page -->
                <section id="page-transaksi" class="page" style="display:none;">
                    <h3>Transaksi Penjualan</h3>
                    <div id="trx-form">
                        <select id="trx-product"></select>
                        <input id="trx-qty" type="number" placeholder="Jumlah" min="1" value="1" style="width:80px">
                        <input id="trx-price" type="text" placeholder="Harga Jual" style="width:210px">
                        <button onclick="addTrxItem()">Tambah</button>
                    </div>
                  <div class="table-responsive">
<table id="trx-items-table" class="common-table">
                        <thead>
                            <tr>
                                <th>Produk</th>
                                <th>Harga</th>
                                <th>Qty</th>
                                <th>Subtotal</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                        <tfoot>
                            <tr>
                                <td colspan="3" style="text-align:right;">Total</td>
                                <td id="trx-total">Rp0</td>
                                <td></td>
                            </tr>
                        </tfoot>
                    </table>
                    </div>
                    <button onclick="submitTrx()">Simpan Transaksi</button>
                    <div id="trx-msg"></div>
                    <div id="last-trx-list"></div>
                </section>
                <!-- Daftar Transaksi Page -->
                <section id="page-daftar" class="page" style="display:none;">
                    <h3>Daftar Transaksi</h3>
                    <div style="margin-bottom:15px;">
                        <label for="filter-date">Filter Tanggal: </label>
                        <input type="date" id="filter-date" onchange="loadTrxList()">
                        <button onclick="resetFilterTrx()">Reset</button>
                    </div>
                    <div id="trx-list"></div>
                </section>
                <!-- Kategori Management Page -->
                <section id="page-kategori" class="page" style="display:none;">
                    <h3>Kelola Kategori</h3>
                    <button id="toggle-category-form-btn" onclick="toggleCategoryForm()">Tambah Kategori Baru</button>
                    <div id="category-form-container" style="display:none; margin-top: 10px;">
                        <h4 id="category-form-title">Tambah Kategori Baru</h4>
                        <input id="newcategory" placeholder="Nama Kategori">
                        <button onclick="saveCategory()" id="category-save-btn">Tambah</button>
                        <button onclick="cancelEditCategory()" id="category-cancel-btn" style="display:none;">Batal</button>
                        <div id="addcategory-msg"></div>
                    </div>
                    <div id="category-list"></div>
                </section>
            </main>
        </div>
    </div>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
